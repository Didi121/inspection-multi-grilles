use crate::grid::{CriterionBuilder, GridInfo, Section};

pub fn build() -> GridInfo {
    let mut b = CriterionBuilder::new();

    GridInfo {
        id: "officine".into(),
        name: "Inspection Officine".into(),
        code: "IP-F-0018".into(),
        version: "1".into(),
        description: "Grille d'inspection des officines de pharmacie selon les BPDisp".into(),
        icon: "üíä".into(),
        color: "#22c55e".into(),
        sections: vec![
            Section { id: 1, title: "Renseignements g√©n√©raux".into(), items: vec![
                b.pre("Loi N¬∞ 2021-03 Art 46", "Identification de la structure (D√©nomination)"),
                b.item("Loi N¬∞ 2021-03 Art 61, 62", "Mode d'acquisition (licences) : Cr√©ation / Transfert / Rachat-Cession"),
                b.item("", "Statut ou mode d'exploitation : Entreprise individuelle / SARL-U / SARL-P / Autre"),
                b.item("Loi N¬∞ 2021-03 Art 62", "Quitus d'exploitation"),
                b.item("", "Adresse, Tel, Mail, BP, GPS"),
                b.item("Loi N¬∞ 2021-03 Art 59,62 ; BPDisp 4.4", "Localisation : D√©partement, Commune, Ville, Arrondissement, Quartier/Village, Zone sanitaire"),
                b.item("", "L'intitul√© de l'attribution de programmation correspond au site choisi"),
                b.item("Loi N¬∞ 2021-03 Art 65", "Horaires d'ouverture au public affich√©s"),
                b.item("Loi N¬∞ 2021-03 Art 65 ; BPDisp 1.14", "Participation au service de garde ‚Äì Programme de garde affich√©"),
            ]},
            Section { id: 2, title: "Syst√®me de management de la qualit√©".into(), items: vec![
                b.pre("Loi N¬∞2021-03 art 1 ; BPDisp 1.3 √† 1.5", "Le pharmacien d'officine a mis en place un SMQ ? La documentation est-elle compl√®te ?"),
                b.pre("BPDisp 1.6", "L'officine est dot√©e d'un Responsable Management Qualit√© (RMQ) ?"),
                b.pre("BPDisp 1.16", "L'officine est dot√©e d'un syst√®me de gestion de risque qualit√©"),
                b.item("BPDisp 1.15 √† 1.17", "Le syst√®me en place permet de garantir et de sauvegarder en toute circonstance la vie et la s√©curit√© du patient"),
                b.pre("BPDisp 1.31a, f", "Les moyens n√©cessaires sont disponibles pour la mise en ≈ìuvre de l'acte pharmaceutique et son homog√©n√©it√©"),
                b.pre("BPDisp 1.31g, 7.21, 7.27", "Les moyens n√©cessaires sont disponibles pour la tra√ßabilit√© de l'acte pharmaceutique y compris les interventions pharmaceutiques"),
            ]},
            Section { id: 3, title: "Personnel".into(), items: vec![
                b.pre("BPDisp 2.2", "L'officine dispose de personnel en nombre suffisant poss√©dant les qualifications n√©cessaires ainsi qu'une exp√©rience pratique ?"),
                b.pre("BPDisp 2.3", "Organigramme √©tabli et affich√© ? Missions et fonctions individuelles clairement d√©finies et d√©crites par √©crit (Fiche de fonction) ?"),
                b.pre("BPDisp 2.4", "Tous les pharmaciens de l'√©quipe officinale sont inscrits √† l'Ordre des pharmaciens ?"),
                b.item("BPDisp 2.9, 2.10", "Pr√©sence du pharmacien (Exercice personnel)"),
                b.item("D√©cret 1296 du 06 nov 2024 Art 16 √† 20", "Respect des conditions d'assistance au pharmacien titulaire"),
                b.item("Loi N¬∞ 2021-03 Art 63 ; Ord n¬∞73-30 art 18 ; D√©cret 1296 Art 21-24 ; BPDisp 2.5", "Respect des conditions de remplacement : Notification, Dur√©e, Identit√© du rempla√ßant, Motif"),
                b.item("BPDisp 2.11", "Port de l'insigne et/ou badge professionnel indiquant la qualification"),
                b.item("BPDisp 2.12", "Entretien annuel, d√©finition des objectifs et fixation des moyens de r√©alisation"),
                b.pre("BPDisp 2.8", "Formation initiale ? Adapt√©e ?"),
                b.pre("BPDisp 2.14 √† 2.20", "Formation continue ? Plan de formation ? Adapt√©e ? Couvre l'ensemble du personnel"),
                b.item("BPDisp 2.18", "Enregistrement et suivi des formations (attestations, comptes rendus, √©valuation de l'efficacit√©)"),
                b.item("BPDisp 2.21", "Proc√©dures relatives √† la sant√© et √† l'hygi√®ne du personnel ? Hygi√®ne adapt√©e (blouse, etc.) ? Visite m√©dicale ?"),
            ]},
            Section { id: 4, title: "Documentation".into(), items: vec![
                b.pre("LOI N¬∞ 97-025 art 54,69-71 ; D√©cret 1296 Art 28 ; BPDisp 3.4-3.9", "Ordonnancier (√† conserver 10 ans) : c√¥t√© et paraph√©, sans rature ni blanc, renseignements complets"),
                b.pre("", "Registre sp√©cial des stup√©fiants (registre comptable, conserver 10 ans) : c√¥t√© et paraph√©, renseignements complets"),
                b.pre("BPDisp 3.6, 3.7", "Registre des m√©dicaments d√©riv√©s du sang (conserver 40 ans)"),
                b.pre("BPDisp 3.4a", "Registre de pr√©paration magistrale ou officinale"),
                b.item("BPDisp 3.11, 3.12", "Copies des ordonnances √† conserver 3 ans"),
                b.pre("", "Autres documents officiels : Pharmacop√©e, Textes r√®glementaires, Liste nationale des m√©dicaments, Bonnes pratiques"),
                b.pre("BPDisp 1.22-1.28, 3.13-3.15", "Disponibilit√© des proc√©dures couvrant tout ce qui influence la qualit√© (Dispensation, Stockage, Cha√Æne du froid, Pr√©paration, Hygi√®ne‚Ä¶)"),
                b.pre("BPDisp 3.16 √† 3.20", "Ma√Ætrise documentaire"),
                b.pre("BPDisp 3.22", "√âvaluation p√©riodique"),
                b.pre("BPDisp 3.23", "Gestion des modifications des documents"),
                b.pre("BPDisp 3.21", "Tous les documents sont approuv√©s, codifi√©s, dat√©s et sign√©s par le r√©dacteur et l'approbateur"),
                b.item("BPDisp 3.24, 3.26", "Gestion de la diffusion / Responsabilit√© du RMQ"),
                b.item("BPDisp 3.25, 3.27", "Gestion du cycle de vie des documents y compris les retraits"),
                b.item("BPDisp 3.13, 3.14, 3.10", "Disponibilit√© des enregistrements (tra√ßabilit√©, registres)"),
                b.item("BPDisp 2.13, 3.12, 3.16", "Gestion des archives"),
                b.item("BPDisp 3.28 √† 3.31", "Documents informatifs, √©ducatifs et pr√©ventifs pour la sant√© publique"),
            ]},
            Section { id: 5, title: "Locaux et √©quipements".into(), items: vec![
                b.pre("Loi N¬∞ 2021-03 Art 46", "Embl√®me (croix grecque verte), Enseigne (¬´ pharmacie ¬ª), Plaque d'identification"),
                b.pre("Ord 73-30 art 25 ; BPDisp 4.1-4.22 ; D√©cret 1296 Art 26", "Propret√© et ad√©quation des locaux, Accessibilit√©, Conformit√© au plan du dossier ABMed"),
                b.pre("BPDisp 4.7", "Respect des obligations de stockage : Gaz m√©dicaux/inflammables, Produits √† haute toxicit√©"),
                b.pre("BPDisp 4.7, 4.8", "Respect des obligations de s√©curit√© : Syst√®mes de s√©curit√©, Issue(s) de secours"),
                b.pre("BPDisp 4.6, 4.16", "Disposition des m√©dicaments de m√©dication officinale et r√©serv√©s ; Vitrines visibles de l'ext√©rieur"),
                b.pre("BPDisp 3.15, 4.10", "S√©paration de la zone de pr√©paration, d√©limitation du plan de travail, surfaces propres"),
                b.pre("BPDisp 4.18", "√âclairage, stockage lumi√®re/humidit√©, contr√¥le temp√©rature et humidit√©"),
                b.pre("BPDisp 4.21", "Sanitaires, vestiaires, zone de restauration"),
                b.pre("BPDisp 1.7, 4.23", "Mat√©riel qualifi√© et adapt√© ; Enceintes r√©frig√©r√©es ; Glaci√®re isotherme"),
                b.item("BPDisp 4.24", "Mat√©riel maintenu propre, en bon √©tat ; Proc√©dures de fonctionnement, nettoyage, entretien"),
                b.item("BPDisp 4.25", "√âtalonnage/calibration des √©quipements de mesure"),
                b.item("BPDisp 4.26, 4.27", "Syst√®me informatis√© valid√© par l'autorit√© comp√©tente"),
                b.item("BPDisp 4.30", "Contrat fournisseur syst√®me informatis√©"),
                b.item("BPDisp 4.33", "Proc√©dure d'acc√®s informatique, codes personnels"),
                b.item("BPDisp 4.34, 4.35", "Sauvegarde des donn√©es (fiable, externe, hors officine)"),
                b.item("BPDisp 4.36", "Mesures de remplacement en cas de d√©faillance ; Gestion coupures √©lectricit√©"),
                b.item("D√©cret 1296 Art 34 √† 37", "Vente en ligne ? Autorisation ABMed ?"),
            ]},
            Section { id: 6, title: "Approvisionnement".into(), items: vec![
                b.item("BPDisp 5.1, 5.2", "Stock minimum de s√©curit√© (urgence : douleur, diab√®te, allergie‚Ä¶)"),
                b.item("BPDisp 5.3, 5.4 ; Loi N¬∞2021-03 Art 58", "Commerce hors liste m√©dicaments et rem√®de secret"),
                b.item("BPDisp 5.7, 5.8, 5.9", "Processus de commandes, s√©lection fournisseurs, importation (AMM, AC, ASI, AE)"),
                b.item("Loi N¬∞ 97-025 art 68", "Commandes de stup√©fiants : carnet √† souches (conserver 10 ans)"),
                b.item("BPDisp 5.10, 5.13", "Conditions de transport et v√©rification qualit√© r√©ception"),
                b.item("BPDisp 5.11", "R√©ception hors heures d'ouverture : isolement s√©curis√©"),
                b.pre("BPDisp 5.12", "Colis livr√©s r√©ceptionn√©s, v√©rifi√©s et stock√©s en attente de contr√¥le"),
            ]},
            Section { id: 7, title: "Sous-traitance".into(), items: vec![
                b.item("Annexe 6.13, 6.4, 6.10", "Contrat ? Ad√©quation ? Respect des conditions ? Preuves (rapport d'audit)"),
            ]},
            Section { id: 8, title: "Dispensation".into(), items: vec![
                b.item("Loi N¬∞ 97-025 Art 51-54,57 ; Loi N¬∞ 2021-03 Art 17 ; BPO 7.1-7.51", "Dispensation des substances v√©n√©neuses (liste I, II, stup√©fiants) sur ordonnance obligatoire"),
                b.item("", "Premi√®re d√©livrance listes I et II : ordonnance de moins de 3 mois"),
                b.item("", "Renouvellement liste II : respect posologie et quantit√©s, max 12 mois"),
                b.item("BPDisp 7.14, 7.15", "Le pharmacien assure int√©gralement l'acte de dispensation conforme aux bonnes pratiques"),
                b.item("BPDisp 7.16", "Surveillance et contr√¥le de l'ex√©cution de la dispensation"),
                b.item("BPDisp 7.17", "Substitution : accord prescripteur (sauf urgence et int√©r√™t du patient)"),
                b.item("BPDisp 7.18", "Refus de dispenser en cas de risque pour le patient"),
                b.item("BPDisp 7.19 √† 7.42", "Acte complet : analyse, v√©rification, enregistrement, conseils, pr√©paration des doses"),
                b.item("BPDisp 7.34", "Mentions apr√®s ex√©cution : timbre, N¬∞ enregistrement, date, quantit√©s d√©livr√©es"),
                b.item("", "Dispensation exceptionnelle pour traitement chronique"),
                b.item("", "Dispositions sp√©cifiques m√©dicaments v√©t√©rinaires"),
                b.item("", "Dispositions DM, DM-DIV, laits infantiles, pansements, cosm√©tiques, compl√©ments"),
                b.item("Loi n¬∞97-025 ; BPDisp 7.36", "Dispensation stup√©fiants : prescription en toutes lettres, carnet √† souches"),
                b.item("BPDisp 7.43-7.48", "Conseil, √©valuation usage d√©tourn√©, dossier pharmaceutique, historique"),
                b.item("Loi N¬∞ 2021-03 Art 77 ; Arr√™t√© n¬∞2021-0069", "Notification des √©v√®nements ind√©sirables"),
                b.item("BPDisp 7.52-7.59", "Vente en ligne : autorisation, m√©dicaments non soumis √† prescription"),
                b.item("", "Espace commandes en ligne, protocole emballage"),
                b.item("BPDisp 7.65", "Respect liste m√©dicaments, taux de r√©duction (10%)"),
                b.item("BPDisp 7.60-7.64", "Livraison √† domicile : habilitation, conditions de conservation"),
            ]},
            Section { id: 9, title: "Retours / R√©clamations / Retraits / Rappels de lots".into(), items: vec![
                b.item("BPDisp 8.3, 8.9, 8.10", "Gestion des retours, m√©dicaments d√©fectueux, proc√©dures de s√©curit√©"),
                b.item("BPDisp 8.4", "M√©dicaments non utilis√©s rapport√©s par les particuliers"),
                b.item("BPDisp 8.5-8.8", "Produits r√©cup√©r√©s : redistribution, stockage, stup√©fiants"),
                b.item("BPDisp 8.12-8.13", "Retraits et rappels de lots, notification patients"),
            ]},
            Section { id: 10, title: "Destruction des d√©chets pharmaceutiques".into(), items: vec![
                b.item("BPDisp 9.2", "Gestion et destruction des d√©chets (d√©stockage, tra√ßabilit√©)"),
            ]},
            Section { id: 11, title: "Pr√©parations magistrales et officinales / Reconditionnement".into(), items: vec![
                b.pre("BPDisp 3.4-a ; 3.15 ; 4.10", "Personnel qualifi√©, local adapt√© avec pr√©paratoire, √©quipements qualifi√©s"),
                b.item("", "Mati√®re premi√®re : validit√©, eau purifi√©e, certificats d'analyse"),
                b.item("", "Proc√©dures de pr√©paration et reconditionnement, contr√¥les"),
                b.item("BPDisp 3.4", "√âtiquetage des pr√©parations, documentations sp√©cifiques"),
                b.item("", "Lib√©ration de lot, retours, r√©clamations, prix"),
            ]},
            Section { id: 12, title: "Publicit√© / Pratique ill√©gale / Gestion des PSQIF".into(), items: vec![
                b.item("Ord n¬∞73-30 Art 27-35 ; BPDisp 1.20", "Publicit√©, √©chantillons, techniques promotionnelles, cadeaux"),
                b.item("Loi N¬∞ 2021-03 Art 54", "Pratique ill√©gale : consultations, actes m√©dicaux, soins infirmiers"),
                b.item("BPDisp 5.5", "Syst√®me pr√©vention/d√©tection/gestion PSQIF"),
            ]},
            Section { id: 13, title: "Auto-inspection / Audit interne".into(), items: vec![
                b.item("BPDisp 10.1-10.9", "Couverture du SMQ, ex√©cution √† intervalles r√©guliers, audits ind√©pendants"),
                b.item("", "Enregistrement : tra√ßabilit√©, comptes rendus, diffusion √† l'√©quipe"),
                b.item("", "Mesures pr√©ventives et correctives par le pharmacien titulaire et le RMQ"),
                b.item("", "Suivi organis√© : v√©rification de l'application et des r√©sultats"),
            ]},
        ],
    }
}
